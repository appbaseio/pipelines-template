{
  "enabled": true,
  "description": "Pipeline to show how to use cache and record analytics",
  "routes": [
    {
      "path": "/cache-and-analytics/_reactivesearch",
      "method": "POST",
      "classify": {
        "category": "reactivesearch"
      }
    }
  ],
  "envs": {
    "category": "reactivesearch",
    "index": [
      "good-books-ds-pipeline"
    ],
    "urlValues": {
      "cache": true
    }
  },
  "global_envs": [
    {
      "key": "ES_URL",
      "value": "",
      "description": "The ElasticSearch URL to run ES requests to",
      "label": "ElasticSearch URL",
      "validate": {
        "url": "${ES_URL}",
        "method": "GET",
        "expected_status": 200
      }
    }
  ],
  "stages": [
    {
      "use": "authorization"
    },
    {
      "use": "useCache"
    },
    {
      "use": "reactivesearchQuery",
      "continueOnError": false
    },
    {
      "use": "elasticsearchQuery",
      "continueOnError": false,
      "inputs": {
        "url": "${ES_URL}"
      }
    },
    {
      "use": "recordAnalytics"
    }
  ]
}